<!-- <ion-header>
  <ion-navbar>
    <ion-title>设 置</ion-title>
  </ion-navbar>
</ion-header> -->

<ion-content padding>
  <div class="visitor-container">
    <div class="list-area" [class.expand]="(pageStatus$ | async) === 0">
      <hz-grid-header type="visitor" [activeIndexSub]="listStatusChangeSub" [headerEventSub]="headerEventSub"></hz-grid-header>

      <hz-grid-filter *ngIf="(listStatus$ | async) === 0"
      [showSearch]="(pageStatus$ | async) === 0"
        [filterSub]="visitorFilterSub"
        [filterOptions]="filterOptions"
        placeholder="请输入客户名">
      </hz-grid-filter>
      <hz-matcher-filter *ngIf="(listStatus$ | async) === 1"
      [expand]="(pageStatus$ | async) === 0"
        [filterSub]="matcherFilterSub">
      </hz-matcher-filter>

      <visitor-grid *ngIf="(listStatus$ | async) === 0" type="visitor"
        (showDetail)="updateDetailID($event)" [expand]="(pageStatus$ | async) === 0"
        [dataItems]="visitors$ | async">
      </visitor-grid>
      <visitor-grid *ngIf="(listStatus$ | async) === 1" type="matcher"
      (showDetail)="updateDetailID($event)"
      (agreeMatcher)="ensureAgreeMatcher($event)"
      (refuseMatcher)="ensureRefuseMatcher($event)"
      [expand]="(pageStatus$ | async) === 0"
      [dataItems]="matchers$ | async">
    </visitor-grid>

      <p class="load-more" tappable *ngIf="showLoadMore$ | async" (click)="loadMore()">加载更多</p>
    </div>

    <div class="detail-area" [class.expand]="(pageStatus$ | async) === 1">
      <visitor-detail
      *ngIf="showDetailID$ | async" [detail]="currentDetail$ | async"
      [expand]="(pageStatus$ | async) === 1"
        [logs]="currentLogs$ | async"
        [portray]="currentPortray$ | async"
        (invite)="ensureInvite()"
        (cancelMatcher)="ensureCancelMatcher($event)"
        (agreeMatcher)="ensureAgreeMatcher($event)"
        (refuseMatcher)="ensureRefuseMatcher($event)"
        (createLog)="ensureCreateLog()">
      </visitor-detail>
    </div>

    <hz-toggle-detail *ngIf="(showDetailID$ | async)" [collapse]="(pageStatus$ | async) === 1" (toggle)="toggleLog()"></hz-toggle-detail>
  </div>
</ion-content>
